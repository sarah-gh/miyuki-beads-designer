import{G as ie}from"./PeyoteGridEditor-C1hTxU6h.js";import{r as g,T as q,n as T,S as U,J as z,P as D,K as F,O as j,L as J,M as L,w as K,p as Q,c as V,o as P,N as X,Q as Y,R as N,U as I,_ as Z,a,V as le,t as E,H as S,b as W,W as ce}from"./index-DW8i2Z9X.js";const de={__name:"MiyukiBeads",props:{pattern:{type:Array,required:!0},rows:{type:Number,default:10},cols:{type:Number,default:50},textureRotation:{type:Number,default:90}},setup(y){const d=y,t=g(null);let c,i,o,r,l=[];const R=new q,x=new Map;function _(s){return typeof s=="string"&&(s.startsWith("/miyuki-beads-designer/beads/")||s.startsWith("/beads/")||s.startsWith("data:image/"))}function G(s,f=0){if(_(s)){const p=s;let v=x.get(p);v||(v=R.load(p,m=>{m.colorSpace=N,o&&(m.anisotropy=o.capabilities.getMaxAnisotropy())},void 0,m=>{console.error("Error loading texture:",p,m)}),v.colorSpace=N,x.set(p,v));const e=v.clone();return e.rotation=f,new I({color:16777215,map:e,roughness:.1,metalness:.1,clearcoat:.5,clearcoatRoughness:.1})}return new I({color:s,roughness:.1,metalness:.1,clearcoat:.5,clearcoatRoughness:.1})}function A(){let s=null;l.length>0&&l[0].geometry&&(s=l[0].geometry),l.forEach(f=>{c.remove(f),f.material&&(f.material.map&&f.material.map.dispose(),f.material.dispose())}),l=[],s&&s.dispose()}function u(){const s=new X(.7,.7,1.1,32),f=(d.cols-1)/2,p=(d.rows-1)/2,v=d.textureRotation*Math.PI/50;for(let e=0;e<d.rows;e++)for(let n=0;n<d.cols;n++){const m=e*d.cols+n,h=d.pattern[m]||"#ffffff",b=G(h,v),w=new Y(s,b),M=n%2===1?.6:0;w.position.set((n-f)*1.2,-(e-p)*1.2-M,0),c.add(w),l.push(w)}}return T(()=>{c=new U,c.background=new z(15790320),i=new D(45,t.value.clientWidth/t.value.clientHeight,.1,1e3),i.position.set(50,-50,50),o=new F({antialias:!0}),o.setPixelRatio(Math.min(window.devicePixelRatio||1,2));function s(){if(!t.value)return;const e=t.value.clientWidth,n=t.value.clientHeight;e===0||n===0||(i.aspect=e/n,i.updateProjectionMatrix(),o.setSize(e,n,!1))}s(),t.value.appendChild(o.domElement);const f=new ResizeObserver(()=>{s()});f.observe(t.value),o.__resizeObserver=f,r=new j(i,o.domElement),c.add(new J(16777215,.5));const p=new L(16777215,3);p.position.set(10,10,10),c.add(p),u();function v(){requestAnimationFrame(v),r.update(),o.render(c,i)}v(),window.addEventListener("resize",s),o.__resizeHandler=s}),K(()=>d.pattern,()=>{A(),u()},{deep:!0}),Q(()=>{o&&o.__resizeHandler&&window.removeEventListener("resize",o.__resizeHandler),o&&o.__resizeObserver&&t.value&&o.__resizeObserver.disconnect(),A(),x.forEach(s=>{s.dispose()}),x.clear(),r&&r.dispose(),o&&o.dispose()}),(s,f)=>(P(),V("div",{ref_key:"container",ref:t,class:"bead-container"},null,512))}},fe={class:"bracelet-wrapper"},ue={class:"canvas-container"},pe={class:"toolbar"},ve={class:"info-panel"},me={class:"info-item"},he={class:"info-value"},be={class:"info-item"},we={class:"info-value"},ge={__name:"BraceletPreview",props:{pattern:{type:Array,required:!0},rows:{type:Number,required:!0},cols:{type:Number,required:!0},width:{type:Number,default:900},height:{type:Number,default:600},textureRotation:{type:Number,default:90}},setup(y,{expose:d}){const t=y,c=g(null);let i,o,r,l,R=[];const x=new q,_=new Map;function G(e){return typeof e=="string"&&(e.startsWith("/miyuki-beads-designer/beads/")||e.startsWith("/beads/")||e.startsWith("data:image/"))}function A(e,n=0){if(G(e)){const h=e;let b=_.get(h);b||(b=x.load(h,M=>{M.colorSpace=N,r&&(M.anisotropy=r.capabilities.getMaxAnisotropy())},void 0,M=>{console.error("Error loading texture:",h,M)}),b.colorSpace=N,_.set(h,b));const w=b.clone();return w.rotation=n,new I({color:16777215,map:w,roughness:.25,metalness:.15,clearcoat:.4,clearcoatRoughness:.1})}new z("#b58a3a");const m=new z(e);return new I({color:m,roughness:.25,metalness:.15,clearcoat:.4,clearcoatRoughness:.1})}function u(){R.forEach(e=>{i.remove(e),e.material&&(e.material.map&&e.material.map.dispose(),e.material.dispose())}),R=[]}function s(){if(!i)return;u();const e=20,n=Math.PI*1.55,m=-n/2,h=n/t.rows,b=e*h*.98,w=.95,$=1,M=new X(w*.7,w*.7,b,16);for(let k=0;k<t.rows;k++)for(let B=0;B<t.cols;B++){let C="#ffffff";if(Array.isArray(t.pattern[0]))C=t.pattern[k]&&t.pattern[k][B]?t.pattern[k][B]:"#ffffff";else{const re=k*t.cols+B;C=t.pattern[re]||"#ffffff"}(!C||C==="#"||C.length<3)&&(C="#ffffff",console.warn("Invalid color detected:",C,"using default white"));const ee=t.textureRotation*Math.PI/55,te=A(C,ee),ae=B%2===1?.5:0,H=m+(k+.5+ae)*h,se=(t.cols/2-.5-B)*$,ne=e*Math.sin(H),oe=e*Math.cos(H),O=new Y(M,te);O.position.set(ne,se,oe),O.rotation.z=Math.PI/2,O.rotation.y=H,i.add(O),R.push(O)}}function f(){i=new U,i.background=new z(15987699),o=new D(42,t.width/t.height,.1,2e3),o.position.set(0,3,95),o.lookAt(0,0,0),r=new F({antialias:!0,preserveDrawingBuffer:!0}),r.setPixelRatio(Math.min(window.devicePixelRatio||1,2)),r.setSize(t.width,t.height,!1),c.value.appendChild(r.domElement),i.add(new J(16777215,.7));const e=new L(16777215,1.1);e.position.set(8,10,12),i.add(e);const n=new L(16777215,.6);n.position.set(-8,-3,8),i.add(n),l=new j(o,r.domElement),l.enableDamping=!0,l.target.set(0,0,0);function m(){requestAnimationFrame(m),l.update(),r.render(i,o)}m()}function p(){r&&(l.update(),r.render(i,o))}function v(){p();const e=r.domElement.toDataURL("image/png"),n=document.createElement("a");n.href=e,n.download="bracelet.png",n.click()}return T(()=>{f(),s(),p()}),K(()=>[t.pattern,t.rows,t.cols,t.textureRotation],()=>{s(),p()},{deep:!0}),Q(()=>{u(),_.forEach(e=>{e.dispose()}),_.clear(),l&&l.dispose(),r&&r.dispose()}),d({downloadImage:v}),(e,n)=>(P(),V("div",fe,[n[4]||(n[4]=a("div",{class:"header"},[a("h2",{class:"title"},"Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¯Ø³ØªØ¨Ù†Ø¯"),a("p",{class:"subtitle"},"Ù†Ù…Ø§ÛŒØ´ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø·Ø±Ø­ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡")],-1)),a("div",ue,[a("div",{ref_key:"container",ref:c,class:"bracelet-canvas"},null,512),n[0]||(n[0]=le('<div class="canvas-overlay" data-v-fcb625a0><div class="controls-hint" data-v-fcb625a0><div class="hint-item" data-v-fcb625a0><span class="hint-icon" data-v-fcb625a0>ğŸ–±ï¸</span><span data-v-fcb625a0>Ø¨Ø±Ø§ÛŒ Ú†Ø±Ø®Ø§Ù†Ø¯Ù† Ú©Ù„ÛŒÚ© Ùˆ Ø¯Ø±Ú¯ Ú©Ù†ÛŒØ¯</span></div><div class="hint-item" data-v-fcb625a0><span class="hint-icon" data-v-fcb625a0>ğŸ”</span><span data-v-fcb625a0>Ø¨Ø±Ø§ÛŒ Ø²ÙˆÙ… Ø§Ø³Ú©Ø±ÙˆÙ„ Ú©Ù†ÛŒØ¯</span></div></div></div>',1))]),a("div",pe,[a("button",{class:"btn btn-primary",onClick:v},n[1]||(n[1]=[a("span",{class:"btn-icon"},"ğŸ“¥",-1),a("span",null,"Ø¯Ø§Ù†Ù„ÙˆØ¯ ØªØµÙˆÛŒØ±",-1)])),a("div",ve,[a("div",me,[n[2]||(n[2]=a("span",{class:"info-label"},"Ø§Ø¨Ø¹Ø§Ø¯:",-1)),a("span",he,E(y.cols)+" Ã— "+E(y.rows),1)]),a("div",be,[n[3]||(n[3]=a("span",{class:"info-label"},"ØªØ¹Ø¯Ø§Ø¯ Ù…Ù‡Ø±Ù‡:",-1)),a("span",we,E(y.cols*y.rows),1)])])])]))}},ye=Z(ge,[["__scopeId","data-v-fcb625a0"]]),xe={class:"home-container"},_e={class:"app-header flex items-start justify-between mb-3!"},Me={class:"stats-section"},Ce={class:"stat-item"},Re={class:"stat-number"},ke={class:"stat-item"},Be={class:"stat-number"},Pe={class:"stat-item"},Ee={class:"stat-number"},Ae={class:"stat-item"},Ge={class:"stat-number"},Oe={class:"content-container"},Se={__name:"PeyoteGrid",setup(y){const d=g(16),t=g(80),c=g(Array(16*80).fill("#ffffff")),i=g(!0),o=g(!1),r=g(!1),l=g(!1);function R(){i.value=!0,o.value=!1,r.value=!1,l.value=!1}function x(){o.value=!0,i.value=!1,r.value=!1,l.value=!1}function _(){r.value=!0,o.value=!1,i.value=!1,l.value=!1}function G(){l.value=!0,i.value=!1,o.value=!1,r.value=!1}function A(u){if(!Array.isArray(u)||u.length===0){c.value=[],d.value=0,t.value=0;return}d.value=u.length,t.value=Array.isArray(u[0])?u[0].length:0,c.value=u.flat()}return(u,s)=>(P(),V("div",xe,[a("header",_e,[a("div",{class:"header-content"},[a("div",{class:"header-actions mt-3! flex items-center gap-2"},[a("button",{class:"rounded-md bg-cyan-950 px-4! py-1! text-[14px] text-white",onClick:R}," ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ø´Ø¨Ú©Ù‡ "),a("button",{class:"rounded-md bg-blue-900 px-4! py-1! text-[14px] text-white",onClick:x}," Ù†Ù…Ø§ÛŒØ´ Ù…Ù‡Ø±Ù‡â€ŒÙ‡Ø§ "),a("button",{class:"rounded-md bg-emerald-900 px-4! py-1! text-[14px] text-white",onClick:_}," Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¯Ø³ØªØ¨Ù†Ø¯ "),a("button",{class:"rounded-md bg-emerald-900 px-4! py-1! text-[14px] text-white",onClick:G}," Ù…Ø±Ø§Ø­Ù„ Ø§Ø¬Ø±Ø§ ")])]),a("div",Me,[a("div",Ce,[a("div",Re,E(d.value),1),s[0]||(s[0]=a("div",{class:"stat-label"},"Ø±Ø¯ÛŒÙ",-1))]),a("div",ke,[a("div",Be,E(t.value),1),s[1]||(s[1]=a("div",{class:"stat-label"},"Ø³ØªÙˆÙ†",-1))]),a("div",Pe,[a("div",Ee,E(c.value.length),1),s[2]||(s[2]=a("div",{class:"stat-label"},"Ù…Ù‡Ø±Ù‡",-1))]),a("div",Ae,[a("div",Ge,E((c.value.length/190).toFixed(2)),1),s[3]||(s[3]=a("div",{class:"stat-label"},"Ú¯Ø±Ù…",-1))])])]),a("div",Oe,[i.value?(P(),S(ie,{key:0,class:"content-component","initial-pattern":c.value,"initial-rows":d.value,"initial-cols":t.value,onUpdateGrid:A},null,8,["initial-pattern","initial-rows","initial-cols"])):W("",!0),o.value?(P(),S(de,{key:1,pattern:c.value,rows:d.value,cols:t.value,class:"content-component"},null,8,["pattern","rows","cols"])):W("",!0),r.value?(P(),S(ye,{key:2,pattern:c.value,rows:d.value,cols:t.value,class:"content-component"},null,8,["pattern","rows","cols"])):W("",!0),l.value?(P(),S(ce,{key:3,pattern:c.value,rows:d.value,cols:t.value,class:"content-component"},null,8,["pattern","rows","cols"])):W("",!0)])]))}},Ie=Z(Se,[["__scopeId","data-v-d8323675"]]);export{Ie as default};
