import{_ as jt,r as y,G as ge,m as wt,w as ct,n as Mt,p as Pt,X as It,c as u,a as t,b as I,x as C,t as j,q as U,v as A,F as H,u as J,Y as Me,o as d,z as ne,A as ve}from"./index-DW8i2Z9X.js";const Rt={class:"peyote-editor-container overflow-auto"},Ot={class:"mobile-control-bar"},Ut={key:0,class:"pinned-section"},At={class:"pinned-section-header"},Vt={class:"pinned-section-title"},Nt={class:"pinned-section-content"},zt={key:0,class:"pinned-dimensions"},Et={class:"dimension-inputs"},Tt={class:"dimension-label"},Dt={class:"dimension-label"},Gt={class:"dimension-label"},Lt={class:"dimension-label"},Wt={class:"dimension-label"},Ht={class:"orientation-toggle-group"},Jt={key:1,class:"pinned-color"},Ft={class:"color-picker-container"},Bt={class:"color-value"},Xt={class:"recent-colors-header"},Yt={class:"recent-colors-grid"},qt=["title","onClick"],Qt=["onClick"],Kt={key:2,class:"pinned-mode"},Zt={class:"mode-toggle"},el={key:3,class:"pinned-image"},tl={class:"image-picker-container"},ll={class:"available-images-grid"},nl=["onClick"],ol=["src","alt"],sl={class:"image-name"},il={key:0,class:"recent-images-section"},al={class:"recent-images-grid"},rl=["onClick"],cl=["src","alt"],ul=["onClick"],dl={key:4,class:"pinned-tools"},vl={class:"tools-grid"},pl=["disabled"],ml=["disabled"],bl=["disabled"],fl=["disabled"],gl=["disabled"],hl={key:5,class:"pinned-export"},Cl={class:"grid grid-cols-2 gap-2"},yl={class:"mobile-panel-content"},kl={class:"mobile-image-section"},xl={class:"upload-section grid grid-cols-2 gap-2"},_l={class:"upload-label"},$l={class:"upload-label"},Sl={key:0,class:"image-preview"},jl=["src"],wl={class:"mobile-controls-content"},Ml={class:"controls-content"},Pl={class:"dimensions-section"},Il={class:"section-header"},Rl=["title"],Ol={class:"dimension-inputs"},Ul={class:"dimension-label"},Al={class:"dimension-label"},Vl={class:"dimension-label"},Nl={class:"dimension-label"},zl={class:"color-section"},El={class:"section-header"},Tl=["title"],Dl={class:"color-picker-container"},Gl={class:"color-value"},Ll={class:"recent-colors-header mt-3!"},Wl={class:"recent-colors-grid"},Hl=["title","onClick"],Jl=["onClick"],Fl={class:"mode-section"},Bl={class:"section-header"},Xl=["title"],Yl={class:"mode-toggle"},ql={key:0,class:"mode-section"},Ql={class:"section-header"},Kl=["title"],Zl={class:"image-picker-container"},en={class:"available-images-grid"},tn=["onClick"],ln=["src","alt"],nn={class:"image-name"},on={key:0,class:"recent-images-section"},sn={class:"recent-images-grid"},an=["onClick"],rn=["src","alt"],cn=["onClick"],un={class:"tools-section"},dn={class:"section-header"},vn=["title"],pn={class:"tools-grid"},mn=["disabled"],bn=["disabled"],fn=["disabled"],gn=["disabled"],hn=["disabled"],Cn={class:"background-color-section !mt-4"},yn={class:"background-color-controls"},kn={class:"export-section"},xn={class:"section-header"},_n=["title"],$n={class:"grid grid-cols-2 gap-2"},Sn={key:0,class:"image-section"},jn={class:"upload-section grid grid-cols-2 gap-2"},wn={class:"upload-label"},Mn={class:"upload-label"},Pn={key:0,class:"image-preview"},In=["src"],Rn={class:"main-content"},On={class:"p-4"},Un={key:0,class:"flex items-start",style:{gap:"0px"}},An=["onMousedown","onMouseenter"],Vn={key:1,class:"flex flex-col items-start",style:{gap:"0px"}},Nn=["onMousedown","onMouseenter"],zn={key:2,class:"flex h-full items-center justify-center text-gray-500"},En={class:"controls-panel"},Tn={class:"controls-content"},Dn={class:"dimensions-section"},Gn={class:"section-header"},Ln=["title"],Wn={class:"dimension-inputs"},Hn={class:"dimension-label"},Jn={class:"dimension-text"},Fn={class:"dimension-label"},Bn={class:"dimension-text"},Xn={class:"dimension-label"},Yn={class:"dimension-text"},qn={class:"dimension-label"},Qn={class:"dimension-text"},Kn={class:"dimension-label"},Zn={class:"orientation-toggle-group"},eo={class:"section-header"},to={class:"color-section"},lo={class:"section-header"},no=["title"],oo={class:"color-picker-container"},so={class:"color-value"},io={class:"recent-colors-header mt-3!"},ao={class:"recent-colors-grid"},ro=["title","onClick"],co=["onClick"],uo={class:"mode-section"},vo={class:"section-header"},po=["title"],mo={class:"mode-toggle"},bo={key:0,class:"image-section"},fo={class:"section-header"},go=["title"],ho={class:"image-picker-container"},Co={class:"available-images-grid"},yo=["onClick"],ko=["src","alt"],xo={class:"image-name"},_o={key:0,class:"recent-images-section"},$o={class:"recent-images-grid"},So=["onClick"],jo=["src","alt"],wo=["onClick"],Mo={class:"tools-section"},Po={class:"section-header"},Io=["title"],Ro={class:"tools-grid"},Oo=["disabled"],Uo=["disabled"],Ao=["disabled"],Vo=["disabled"],No=["disabled"],zo={class:"background-color-section !mt-4"},Eo={class:"background-color-controls"},To={class:"export-section"},Do={class:"section-header"},Go=["title"],Lo={class:"grid grid-cols-2 gap-2"},Wo={__name:"PeyoteGridEditor",props:{initialPattern:{type:Array,default:null},initialRows:{type:Number,default:null},initialCols:{type:Number,default:null}},emits:["update-grid"],setup(ut,{emit:dt}){const Z=ut,he=dt,re=y(null),V=y([]),N=y("color"),Ce=y(!0),ye=y([]),R=y(null),pe=y(!1),v=y(null);function vt(){pe.value=!pe.value}function F(n){v.value===n?v.value=null:(v.value=n,pe.value=!1)}function pt(){v.value=null}function mt(n){return{dimensions:"üìê ÿßÿ®ÿπÿßÿØ ÿ¥ÿ®⁄©Ÿá",color:"üé® ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø",mode:"üé® ÿ≠ÿßŸÑÿ™ ÿ∑ÿ±ÿßÿ≠€å",image:"üñºÔ∏è ÿßŸÜÿ™ÿÆÿßÿ® ÿ™ÿµŸà€åÿ±",tools:"üõ†Ô∏è ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß",export:"üì§ ÿÆÿ±Ÿàÿ¨€å"}[n]||n}const b=y(Z.initialCols??12),p=y(Z.initialRows??50),k=y(15),x=y(17),S=y("vertical"),Pe=[{key:"DB-1510",hex:"#efe9df"},{key:"DB-1503",hex:"#efbfc7"},{key:"DB-0914",hex:"#d92e5b"},{key:"DB-1832",hex:"#d39c2a"}],w=y(Pe[2].hex),$=y("#ffffff"),Ye=ge(()=>Array.from({length:b.value},(n,e)=>e)),qe=ge(()=>Array.from({length:p.value},(n,e)=>e)),i=wt([]);function Ie(n=null){const e=Array.from({length:p.value},()=>Array.from({length:b.value},()=>$.value));if(n&&Array.isArray(n)&&n.length>0)for(let l=0;l<p.value;l++)for(let o=0;o<b.value;o++){const a=l*b.value+o;a<n.length&&(e[l][o]=n[a]||$.value)}i.splice(0,i.length,...e),ae.value=!0,console.info("Grid initialized:",{rows:p.value,cols:b.value,gridLength:i.length,hasInitialPattern:!!n}),T.value=[JSON.parse(JSON.stringify(i))],D.value=0}ge(()=>S.value==="horizontal"?b.value*x.value+x.value:p.value*x.value+x.value),ge(()=>S.value==="horizontal"?p.value*k.value+k.value:b.value*k.value+k.value);const Qe=ge(()=>{var e,l;const n=ae.value&&i.length===p.value&&i.length>0&&((e=i[0])==null?void 0:e.length)===b.value;return console.info("Grid ready check:",{gridInitialized:ae.value,gridLength:i.length,rows:p.value,cols:b.value,firstRowLength:(l=i[0])==null?void 0:l.length,ready:n}),n}),z=y("paint"),M=y([]),L=y(null),ie=y(!1),Re=y("none"),E=y([]),Oe=y(!1),bt=y(!1),ke=y(null),ce=y(!1),X=y(null),B=y(null),ft=y(null),ae=y(!1),T=y([]),D=y(-1),me=y(!1),ue=y(!1);function xe(){if(me.value)return;const n=JSON.parse(JSON.stringify(i));D.value<T.value.length-1&&(T.value=T.value.slice(0,D.value+1));const e=T.value[D.value];!e||JSON.stringify(n)!==JSON.stringify(e)?(T.value.push(n),D.value=T.value.length-1,T.value.length>10&&(T.value.shift(),D.value--),console.info("Saved to history:",{historyLength:T.value.length,historyIndex:D.value})):console.info("State unchanged, skipping history save")}function ee(){ue.value||(xe(),ue.value=!0)}function Y(){ue.value&&Me(()=>{xe(),ue.value=!1})}ct(()=>[Z.initialPattern,Z.initialRows,Z.initialCols],([n,e,l],[o])=>{ae.value&&n&&Array.isArray(n)&&n.length>0&&n!==o&&(e&&e!==p.value&&(p.value=e),l&&l!==b.value&&(b.value=l),Me(()=>{Ie(n)}))},{deep:!0}),ct([p,b],([n,e],[l,o])=>{if(!ae.value){console.info("Grid not initialized yet, skipping resize");return}const a=Math.max(1,Math.min(200,n||1)),s=Math.max(1,Math.min(200,e||1));a!==n&&(p.value=a),s!==e&&(b.value=s),(a!==l||s!==o)&&(console.info("Dimensions changed:",{oldRows:l,oldCols:o,newRows:a,newCols:s}),Ke(a,s))});function Ke(n,e){var s;const l=p.value,o=b.value;console.info("Resizing grid:",{oldRows:l,oldCols:o,newRows:n,newCols:e}),ee();const a=Array.from({length:n},()=>Array.from({length:e},()=>$.value));if(i.length>0&&i[0]!==void 0)for(let r=0;r<Math.min(l,n);r++)for(let c=0;c<Math.min(o,e);c++)i[r]&&i[r][c]!==void 0&&(a[r][c]=i[r][c]);i.splice(0,i.length,...a),ae.value=!0,console.info("Grid resized successfully. New grid dimensions:",{rows:n,cols:e,actualGridLength:i.length,actualFirstRowLength:(s=i[0])==null?void 0:s.length}),Y()}function Ue(n){if(n===$.value)return;const e=E.value.indexOf(n);e>-1&&E.value.splice(e,1),E.value.unshift(n),E.value.length>20&&(E.value=E.value.slice(0,20))}function Ae(n){const e=E.value.indexOf(n);e>-1&&E.value.splice(e,1)}function Ve(){E.value=[]}function _e(n){const e=V.value.findIndex(l=>l.url===n.url);e>-1&&V.value.splice(e,1),V.value.unshift(n),V.value.length>10&&(V.value=V.value.slice(0,10))}function Ne(n){const e=V.value.findIndex(l=>l.url===n.url);e>-1&&V.value.splice(e,1)}function ze(){V.value=[]}function $e(){N.value="color"}function Se(){N.value="image"}function gt(){const n=["310.jpg","1130.jpg","1135.jpg","2116.jpg","2131.jpg","2132.jpg","725.jpg","877.jpg","f111.jpg","f222.jpg","f333.jpg","f444.jpg","f555.jpg","f666.jpg","f777.jpg","f888.jpg","f999.jpg","f1010.jpg","f1111.jpg","f1212.jpg","f1313.jpg","f1414.jpg","f1515.jpg","Awhite.jpg","Turquoise.jpg","db0042.jpg","db0221.jpg","db0231.jpg","db0268.jpg","db0623.jpg","db0627.jpg","db0635.jpg","db0651.jpg","db0680.jpg","db0721.jpg","db0722.jpg","db0723.jpg","db0725.jpg","db0726.jpg","db0729.jpg","db0759.jpg","db0763.jpg","db0791.jpg","db0796.jpg","db0877.jpg","db1132.jpg","db1133.jpg","db1135.jpg","db1153.jpg","db1262.jpg","db1570.jpg","db1802.jpg","db1832.jpg","db1832-2.jpg","db2111.jpg","db2127.jpg","db2131.jpg","db2132.jpg","db2144.jpg","db2316.jpg","db2352.jpg","db2357.jpg","db310.jpg","db626.jpg","db732.jpg","db856.jpg"];ye.value=n.map(e=>({name:e,url:`/miyuki-beads-designer/beads/${e}`,displayName:e.replace(".jpg","")}))}function de(n){R.value=n,_e(n),Se()}function q(n){z.value=n,oe(),je(),ce.value=!1,X.value=null,B.value=null}function Ze(n,e){if(ie.value){xt(n,e,Re.value);return}switch(Oe.value=!0,ke.value=`${n},${e}`,z.value){case"paint":ee(),ht(n,e);break;case"fill":ee(),yt(n,e),Y();break;case"select":lt(n,e);break;case"selectRect":ce.value=!0,X.value={r:n,c:e},B.value={r:n,c:e};break}}function et(n,e){if(!Oe.value)return;const l=`${n},${e}`;if(l!==ke.value)switch(ke.value=l,z.value){case"paint":Ct(n,e);break;case"select":lt(n,e);break;case"selectRect":ce.value&&(B.value={r:n,c:e});break}}function tt(){z.value==="selectRect"&&ce.value&&X.value&&B.value&&(kt(X.value.r,X.value.c,B.value.r,B.value.c),ce.value=!1,X.value=null,B.value=null),Y(),Oe.value=!1,bt.value=!1,ke.value=null}function ht(n,e){if(i[n]&&i[n][e]!==void 0){const l=i[n][e],o=N.value==="image"&&R.value?R.value.url:w.value;l!==o&&(i[n][e]=o,o===w.value?Ue(w.value):N.value==="image"&&R.value&&o===R.value.url&&_e(R.value))}}function Ct(n,e){if(i[n]&&i[n][e]!==void 0){const l=N.value==="image"&&R.value?R.value.url:w.value;i[n][e]=l,l===w.value?Ue(w.value):N.value==="image"&&R.value&&_e(R.value)}}function yt(n,e){if(!i[n]||i[n][e]===void 0)return;const l=i[n][e],o=N.value==="image"&&R.value?R.value.url:w.value;if(l===o)return;const a=new Set,s=[[n,e]];for(;s.length>0;){const[r,c]=s.pop(),m=`${r},${c}`;a.has(m)||r<0||r>=p.value||c<0||c>=b.value||!i[r]||i[r][c]!==l||(a.add(m),i[r][c]=o,s.push([r+1,c],[r-1,c],[r,c+1],[r,c-1]))}o===w.value?Ue(o):o===re.value&&_e(o)}function lt(n,e){const l=`${n},${e}`,o=M.value.indexOf(l);o>-1?M.value.splice(o,1):M.value.push(l)}function kt(n,e,l,o){const a=Math.min(n,l),s=Math.max(n,l),r=Math.min(e,o),c=Math.max(e,o),m=[];for(let g=a;g<=s;g++)for(let h=r;h<=c;h++)i[g]&&i[g][h]!==void 0&&m.push(`${g},${h}`);m.forEach(g=>{M.value.includes(g)||M.value.push(g)})}function oe(){M.value=[]}function Ee(){if(M.value.length===0){console.warn("No cells selected for copying");return}const n=M.value.map(e=>{var a;const[l,o]=e.split(",").map(Number);return{r:l,c:o,color:((a=i[l])==null?void 0:a[o])||$.value}});L.value=n,console.info(`Copied ${n.length} cells to clipboard`),oe(),Q()}function Te(){if(M.value.length===0){console.warn("No cells selected for cutting");return}ee();const n=M.value.map(e=>{var a;const[l,o]=e.split(",").map(Number);return{r:l,c:o,color:((a=i[l])==null?void 0:a[o])||$.value}});L.value=n,console.info(`Cut ${n.length} cells to clipboard`),M.value.forEach(e=>{const[l,o]=e.split(",").map(Number);i[l]&&i[l][o]!==void 0&&(i[l][o]=$.value)}),oe(),Q(),Y()}function te(n="none"){if(!L.value){console.warn("No content in clipboard to paste");return}ee(),oe();const e=nt(n);if(e.length===0){Y();return}const l=Math.min(...e.map(f=>f.r)),o=Math.min(...e.map(f=>f.c)),a=Math.max(...e.map(f=>f.r)),s=Math.max(...e.map(f=>f.c)),r=(l+a)/2,c=(o+s)/2,m=Math.floor(p.value/2),g=Math.floor(b.value/2),h=m-r,_=g-c;let P=0;e.forEach(({r:f,c:O,color:K})=>{const G=O+_;let W=0;const se=o%2===1,rt=G%2===1;se&&!rt?(W=-1,console.info(`Odd‚ÜíEven: sourceCol=${o}, targetCol=${G}, cellAdjustment=${W}`)):!se&&rt?(W=-1,console.info(`Even‚ÜíOdd: sourceCol=${o}, targetCol=${G}, cellAdjustment=${W}`)):console.info(`Same type: sourceCol=${o}, targetCol=${G}, cellAdjustment=${W}`);const fe=f+h+W,we=G;fe>=0&&fe<p.value&&we>=0&&we<b.value&&i[fe]&&i[fe][we]!==void 0&&(i[fe][we]=K,P++)}),console.info(`Pasted ${P} cells at center with peyote adjustment`),Y()}function xt(n,e,l="none"){if(!L.value)return;ee(),oe();const o=nt(l);if(o.length===0){Y();return}const a=Math.min(...o.map(c=>c.r)),s=Math.min(...o.map(c=>c.c));console.info("transformedMinC",s,"targetC",e);let r=0;o.forEach(({r:c,c:m,color:g})=>{const h=c-a,_=m-s,P=e+_;let f=0;const O=s%2===1,K=P%2===1,G=m%2===1;console.info(`mirrorMode=${l}, sourceIsOdd=${O}, targetIsOdd=${K}, cellColIsOdd=${G}`),l==="none"?O&&!K?(G?f=0:f=-1,console.info(`Odd‚ÜíEven: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)):!O&&K?(G?f=-1:f=-2,console.info(`Even‚ÜíOdd: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)):(f=-1,console.info(`Same type: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)):O&&!K?(G?f=0:f=-1,console.info(`Mirror Odd‚ÜíEven: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)):!O&&K?(G?f=-1:f=-2,console.info(`Mirror Even‚ÜíOdd: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)):(f=0,console.info(`Mirror Same type: sourceCol=${s}, targetCol=${P}, cellAdjustment=${f}`)),console.info("cellAdjustment",f);const W=n+h+f,se=P;console.info(`Pasting cell: orig(${c},${m}) -> new(${W},${se}) offset(${h},${_}) cellAdjustment=${f}`),W>=0&&W<p.value&&se>=0&&se<b.value&&i[W]&&i[W][se]!==void 0&&(i[W][se]=g,r++)}),console.info(`Pasted ${r} cells at position (${n}, ${e}) with per-cell peyote adjustment`),Y()}function Q(n="none"){L.value&&(Re.value=n,ie.value=!0)}function je(){ie.value=!1,Re.value="none"}function le(){return L.value&&L.value.length>0}function nt(n="none"){if(!L.value)return[];const e=Math.min(...L.value.map(s=>s.r)),l=Math.min(...L.value.map(s=>s.c)),o=Math.max(...L.value.map(s=>s.r)),a=Math.max(...L.value.map(s=>s.c));return L.value.map(({r:s,c:r,color:c})=>{let m=s,g=r;return n==="horizontal"?g=l+(a-r):n==="vertical"&&(m=e+(o-s)),{r:m,c:g,color:c}})}function De(){if(M.value.length===0)return;ee();const n=M.value.map(l=>{var s;const[o,a]=l.split(",").map(Number);return{r:o,c:a,color:((s=i[o])==null?void 0:s[a])||$.value}}),e=Math.max(...n.map(l=>l.c));n.forEach(({r:l,c:o,color:a})=>{const s=e-o;s>=0&&s<b.value&&i[l]&&i[l][s]!==void 0&&(i[l][s]=a)}),Y()}function Ge(){if(M.value.length===0)return;ee();const n=M.value.map(l=>{var s;const[o,a]=l.split(",").map(Number);return{r:o,c:a,color:((s=i[o])==null?void 0:s[a])||$.value}}),e=Math.max(...n.map(l=>l.r));n.forEach(({r:l,c:o,color:a})=>{const s=e-l;s>=0&&s<p.value&&i[s]&&i[s][o]!==void 0&&(i[s][o]=a)}),Y()}function Le(){if(D.value<=0){console.warn("No more undo history available");return}ue.value&&(xe(),ue.value=!1),me.value=!0,D.value--;const n=JSON.parse(JSON.stringify(T.value[D.value]));i.splice(0,i.length),n.forEach(e=>{i.push([...e])}),me.value=!1,console.info("Undo performed:",{historyIndex:D.value,historyLength:T.value.length})}function We(){if(D.value>=T.value.length-1){console.warn("No more redo history available");return}me.value=!0,D.value++;const n=JSON.parse(JSON.stringify(T.value[D.value]));i.splice(0,i.length),n.forEach(e=>{i.push([...e])}),me.value=!1,console.info("Redo performed:",{historyIndex:D.value,historyLength:T.value.length})}function ot(){ee();for(let n=0;n<p.value;n++)for(let e=0;e<b.value;e++)i[n]&&i[n][e]!==void 0&&(i[n][e]=$.value);Y()}function be(){return i.map(n=>[...n])}function He(){const n={grid:be(),cols:b.value,rows:p.value,cellWidth:k.value,cellHeight:x.value,selectedColor:w.value,backgroundColor:$.value,orientation:S.value};localStorage.setItem("peyoteGrid",JSON.stringify(n))}function Je(){const n=localStorage.getItem("peyoteGrid");if(n){const e=JSON.parse(n);if(b.value=e.cols||12,p.value=e.rows||36,k.value=e.cellWidth||15,x.value=e.cellHeight||15,w.value=e.selectedColor||Pe[2].hex,$.value=e.backgroundColor||"#ffffff",e.orientation&&(e.orientation==="vertical"||e.orientation==="horizontal")&&(S.value=e.orientation),e.grid){Ke(p.value,b.value);for(let l=0;l<p.value;l++)for(let o=0;o<b.value;o++)i[l][o]=e.grid[l]&&e.grid[l][o]?e.grid[l][o]:null}}}async function Fe(){const n=document.createElement("canvas"),e=n.getContext("2d");S.value==="horizontal"?(n.width=b.value*k.value+k.value/2,n.height=p.value*x.value):(n.width=b.value*k.value,n.height=p.value*x.value+x.value/2),e.fillStyle=$.value,e.fillRect(0,0,n.width,n.height);const l=[];for(let s=0;s<p.value;s++)for(let r=0;r<b.value;r++){const c=i[s][r]||$.value;if(c&&(c.startsWith("data:image/")||c.startsWith("/miyuki-beads-designer/beads/"))){const m=new Promise(g=>{const h=new Image;h.onload=()=>g({img:h,r:s,c:r}),h.onerror=()=>g({img:null,r:s,c:r}),h.src=c});l.push(m)}}const o=await Promise.all(l);for(let s=0;s<p.value;s++)for(let r=0;r<b.value;r++){const c=i[s][r]||$.value;let m,g;if(S.value==="horizontal"){const h=s%2===1?k.value/2:0;m=r*k.value+h,g=s*x.value}else{const h=r%2===1?x.value/2:0;m=r*k.value,g=s*x.value+h}if(c&&(c.startsWith("data:image/")||c.startsWith("/miyuki-beads-designer/beads/"))){const h=o.find(_=>_.r===s&&_.c===r);h&&h.img&&e.drawImage(h.img,m,g,k.value,x.value)}else e.fillStyle=c,e.fillRect(m,g,k.value,x.value)}const a=document.createElement("a");a.download=`peyote-grid-${S.value}.png`,a.href=n.toDataURL(),a.click()}async function Be(){const e=document.createElement("canvas"),l=e.getContext("2d");S.value==="horizontal"?(e.width=(b.value*k.value+k.value/2)*4,e.height=p.value*x.value*4):(e.width=b.value*k.value*4,e.height=(p.value*x.value+x.value/2)*4),l.fillStyle=$.value,l.fillRect(0,0,e.width,e.height);const o=[];for(let r=0;r<p.value;r++)for(let c=0;c<b.value;c++){const m=i[r][c]||$.value;if(m&&(m.startsWith("data:image/")||m.startsWith("/miyuki-beads-designer/beads/"))){const g=new Promise(h=>{const _=new Image;_.onload=()=>h({img:_,r,c}),_.onerror=()=>h({img:null,r,c}),_.src=m});o.push(g)}}const a=await Promise.all(o);for(let r=0;r<p.value;r++)for(let c=0;c<b.value;c++){const m=i[r][c]||$.value;let g,h;if(S.value==="horizontal"){const f=r%2===1?k.value/2:0;g=(c*k.value+f)*4,h=r*x.value*4}else{const f=c%2===1?x.value/2:0;g=c*k.value*4,h=(r*x.value+f)*4}const _=k.value*4,P=x.value*4;if(m&&(m.startsWith("data:image/")||m.startsWith("/miyuki-beads-designer/beads/"))){const f=a.find(O=>O.r===r&&O.c===c);f&&f.img&&l.drawImage(f.img,g,h,_,P)}else l.fillStyle=m,l.fillRect(g,h,_,P)}const s=document.createElement("a");s.download=`peyote-grid-hd-${S.value}.png`,s.href=e.toDataURL(),s.click()}function Xe(){try{const n=[];for(let r=0;r<p.value;r++)for(let c=0;c<b.value;c++){const m=i[r][c]||$.value;n.push(m)}const e={grid:n,rows:p.value,cols:b.value,orientation:S.value,type:"peyote",timestamp:new Date().toISOString()},l=JSON.stringify(e,null,2),o=new Blob([l],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(o),s=document.createElement("a");s.href=a,s.download=`peyote_grid_${p.value}x${b.value}_${S.value}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,s.click(),URL.revokeObjectURL(a)}catch(n){console.error("Error exporting TXT file:",n)}}function st(n){const e=n.target.files[0];if(!e)return;const l=new FileReader;l.onload=o=>{try{const a=o.target.result.trim();console.info("TXT file content:",a);const s=a.split(`
`);if(a.startsWith("{")){const r=JSON.parse(a);if(r.grid&&r.rows&&r.cols){const{grid:c,rows:m,cols:g,orientation:h}=r;if(console.info("Parsed colors:",c.slice(0,10),"...","Length:",c.length),console.info("Expected length:",m*g,"Rows:",m,"Cols:",g),console.info("Orientation:",h||"vertical (default)"),h&&(h==="vertical"||h==="horizontal")&&(S.value=h,console.info("Grid orientation set to:",h)),Array.isArray(c)&&c.every(_=>_===null||_===$.value||typeof _=="string"&&(_.match(/^#[0-9A-Fa-f]{6}$/)||_.startsWith("data:image/")||_.startsWith("/miyuki-beads-designer/beads/"))))if(console.info("Color validation passed"),c.length===m*g){console.info("Length validation passed, updating grid..."),b.value=g,p.value=m,Me(()=>{const _=[];for(let P=0;P<m;P++){const f=[];for(let O=0;O<g;O++){const K=P*g+O,G=c[K];f.push(G??$.value)}_.push(f)}i.splice(0,i.length,..._),console.info("Grid loaded from TXT:",{rows:m,cols:g,orientation:S.value,gridData:_})});return}else console.error("Length mismatch:",c.length,"expected",m*g);else console.error("Color validation failed")}else console.error("Missing required fields in JSON")}if(s.length>2&&s[0].includes("Peyote Grid")){const r=s[0].match(/(\d+)x(\d+)/);if(r){const c=parseInt(r[1]),m=parseInt(r[2]);b.value=c,p.value=m,Me(()=>{const g=[];for(let h=2;h<s.length&&h-2<m;h++){const _=[],P=s[h];for(let f=0;f<c;f++){const O=f*2;if(O+1<P.length){const K=P.substring(O,O+2);_.push(K==="‚ñà‚ñà"?"#FF0000":$.value)}else _.push($.value)}g.push(_)}i.splice(0,i.length,...g)});return}}console.error("Unsupported TXT format")}catch(a){console.error("Error parsing TXT file:",a)}},l.readAsText(e)}function it(n){const e=n.target.files[0];if(!e)return;const l=new FileReader;l.onload=o=>{const a=o.target.result;re.value=a},l.readAsDataURL(e)}function _t(n){return{transform:`translateY(${n%2===1?x.value/2:0}px)`,gap:"0px"}}function $t(n){return{transform:`translateX(${n%2===1?k.value/2:0}px)`,gap:"0px"}}function St(n,e){if(!ce.value||!X.value||!B.value)return!1;const l=Math.min(X.value.r,B.value.r),o=Math.max(X.value.r,B.value.r),a=Math.min(X.value.c,B.value.c),s=Math.max(X.value.c,B.value.c);return n>=l&&n<=o&&e>=a&&e<=s}function at(n,e){var m;const l=((m=i[n])==null?void 0:m[e])||$.value,o=M.value.includes(`${n},${e}`),a=ie.value,s=St(n,e),r=l&&(l.startsWith("data:image/")||l.startsWith("/miyuki-beads-designer/beads/")),c={width:`${k.value}px`,height:`${x.value}px`,boxSizing:"border-box",border:o?"2px solid #3b82f6":s?"2px solid #10b981":a?"1px solid #f59e0b":"1px solid #e5e7eb",cursor:a?"crosshair":"pointer",opacity:a?.9:s?.8:1};return r?{...c,backgroundColor:"transparent",backgroundImage:`url(${l})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:{...c,background:l}}return Mt(()=>{if(console.info("Component mounted. Initial dimensions:",{rows:p.value,cols:b.value,hasInitialPattern:!!Z.initialPattern}),Z.initialPattern&&Z.initialPattern.length>0)Ie(Z.initialPattern);else{Ie();for(let n=0;n<b.value;n++){const e=Math.floor(p.value/2+Math.sin(n/1.5)*(p.value/6));e>=0&&e<p.value&&(i[e][n]=Pe[2].hex)}}gt(),xe(),document.addEventListener("mouseup",tt)}),Pt(()=>{ae.value&&i.length>0&&he("update-grid",be())}),It(()=>{document.removeEventListener("mouseup",tt)}),(n,e)=>(d(),u("div",Rt,[t("div",Ot,[t("button",{class:C(["mobile-menu-btn",{active:pe.value}]),onClick:vt},e[63]||(e[63]=[t("span",{class:"menu-icon"},"‚ò∞",-1),t("span",{class:"menu-text"},"ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß",-1)]),2),e[64]||(e[64]=t("div",{class:"mobile-title"},"üé® Ÿà€åÿ±ÿß€åÿ¥⁄Øÿ± Peyote",-1))]),v.value?(d(),u("div",Ut,[t("div",At,[t("h4",Vt,j(mt(v.value)),1),t("button",{class:"unpin-btn",title:"Unpin Section",onClick:pt}," ‚úï ")]),t("div",Nt,[v.value==="dimensions"?(d(),u("div",zt,[t("div",Et,[t("label",Tt,[e[65]||(e[65]=t("span",{class:"dimension-text"},"ÿ±ÿØ€åŸÅ‚ÄåŸáÿß:",-1)),U(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),type:"number",min:"1",class:"dimension-input"},null,512),[[A,p.value,void 0,{number:!0}]])]),t("label",Dt,[e[66]||(e[66]=t("span",{class:"dimension-text"},"ÿ≥ÿ™ŸàŸÜ‚ÄåŸáÿß:",-1)),U(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),type:"number",min:"1",class:"dimension-input"},null,512),[[A,b.value,void 0,{number:!0}]])]),t("label",Gt,[e[67]||(e[67]=t("span",{class:"dimension-text"},"ÿπÿ±ÿ∂ ÿ≥ŸÑ:",-1)),U(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>k.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,k.value,void 0,{number:!0}]])]),t("label",Lt,[e[68]||(e[68]=t("span",{class:"dimension-text"},"ÿßÿ±ÿ™ŸÅÿßÿπ ÿ≥ŸÑ:",-1)),U(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>x.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,x.value,void 0,{number:!0}]])]),t("div",Wt,[e[69]||(e[69]=t("span",{class:"dimension-text"},"ÿ¨Ÿáÿ™ ⁄Øÿ±€åÿØ:",-1)),t("div",Ht,[t("button",{class:C(["orientation-toggle-btn",{active:S.value==="vertical"}]),onClick:e[4]||(e[4]=l=>S.value="vertical")}," ‚ÜïÔ∏è ÿπŸÖŸàÿØ€å ",2),t("button",{class:C(["orientation-toggle-btn",{active:S.value==="horizontal"}]),onClick:e[5]||(e[5]=l=>S.value="horizontal")}," ‚ÜîÔ∏è ÿßŸÅŸÇ€å ",2)])])])])):I("",!0),v.value==="color"?(d(),u("div",Jt,[t("div",Ft,[U(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>w.value=l),type:"color",class:"color-picker"},null,512),[[A,w.value]]),t("span",Bt,j(w.value),1)]),t("div",Xt,[e[70]||(e[70]=t("h4",{class:"text-sm font-semibold text-gray-700"},"üîÑ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß€å ÿßÿÆ€åÿ±",-1)),E.value.length>0?(d(),u("button",{key:0,class:"clear-colors-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß",onClick:Ve}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")):I("",!0)]),t("div",Yt,[(d(!0),u(H,null,J(E.value,l=>(d(),u("div",{key:l,class:"color-swatch",style:ne({backgroundColor:l}),title:l,onClick:o=>w.value=l},[t("button",{class:"remove-color-btn",onClick:ve(o=>Ae(l),["stop"])}," √ó ",8,Qt)],12,qt))),128))])])):I("",!0),v.value==="mode"?(d(),u("div",Kt,[t("div",Zt,[t("button",{class:C(["mode-btn",{active:N.value==="color"}]),onClick:$e}," üé® ÿ±ŸÜ⁄Ø ",2),t("button",{class:C(["mode-btn",{active:N.value==="image"}]),onClick:Se}," üñºÔ∏è ÿ™ÿµŸà€åÿ± ",2)])])):I("",!0),v.value==="image"?(d(),u("div",el,[t("div",tl,[t("div",ll,[(d(!0),u(H,null,J(ye.value,l=>{var o;return d(),u("div",{key:l.name,class:C(["image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"bead-image"},null,8,ol),t("span",sl,j(l.displayName),1)],10,nl)}),128))])]),V.value.length>0?(d(),u("div",il,[t("div",{class:"recent-images-header"},[e[71]||(e[71]=t("h4",{class:"text-sm font-semibold text-gray-700"}," üîÑ ÿ™ÿµÿßŸà€åÿ± ÿßÿÆ€åÿ± ",-1)),t("button",{class:"clear-images-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ™ÿµÿßŸà€åÿ±",onClick:ze}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")]),t("div",al,[(d(!0),u(H,null,J(V.value,l=>{var o;return d(),u("div",{key:l.url,class:C(["recent-image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"recent-bead-image"},null,8,cl),t("button",{class:"remove-image-btn",onClick:ve(a=>Ne(l),["stop"])}," √ó ",8,ul)],10,rl)}),128))])])):I("",!0)])):I("",!0),v.value==="tools"?(d(),u("div",dl,[t("div",vl,[t("button",{class:C(["tool-btn primary",{active:z.value==="paint"}]),onClick:e[7]||(e[7]=l=>q("paint"))}," üñåÔ∏è Paint ",2),t("button",{class:C(["tool-btn primary",{active:z.value==="fill"}]),onClick:e[8]||(e[8]=l=>q("fill"))}," ü™£ Fill ",2),t("button",{class:C(["tool-btn secondary",{active:z.value==="select"}]),onClick:e[9]||(e[9]=l=>q("select"))}," üìê Select ",2),t("button",{class:C(["tool-btn secondary",{active:z.value==="selectRect"}]),onClick:e[10]||(e[10]=l=>q("selectRect"))}," üì¶ Select Rectangle ",2),t("button",{class:"tool-btn secondary",onClick:Ee}," üìã Copy "),t("button",{class:"tool-btn secondary",onClick:Te}," ‚úÇÔ∏è Cut "),t("button",{class:"tool-btn secondary",onClick:te}," üìç Paste at Center "),t("button",{class:"tool-btn secondary",onClick:e[11]||(e[11]=l=>te("horizontal"))}," üìç Paste at Center (Mirror H) "),t("button",{class:"tool-btn secondary",onClick:e[12]||(e[12]=l=>te("vertical"))}," üìç Paste at Center (Mirror V) "),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[13]||(e[13]=l=>Q())}," üéØ Enable Click-to-Paste ",8,pl),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[14]||(e[14]=l=>Q("horizontal"))}," üéØ Click-to-Paste (Mirror H) ",8,ml),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[15]||(e[15]=l=>Q("vertical"))}," üéØ Click-to-Paste (Mirror V) ",8,bl),ie.value?(d(),u("button",{key:0,class:"tool-btn danger",onClick:je}," ‚ùå Cancel Click-to-Paste ")):I("",!0),t("button",{class:"tool-btn secondary",onClick:oe}," üóëÔ∏è Clear Selection "),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:De}," üîÑ Mirror Selection ",8,fl),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:Ge}," ‚ÜïÔ∏è Mirror Selection Vertical ",8,gl),t("button",{class:"tool-btn secondary",onClick:Le}," ‚Ü©Ô∏è Undo "),t("button",{class:"tool-btn secondary",onClick:We}," ‚Ü™Ô∏è Redo ")])])):I("",!0),v.value==="export"?(d(),u("div",hl,[t("div",{class:"save-load-buttons"},[t("button",{class:"export-btn success",onClick:He}," üíæ ÿ∞ÿÆ€åÿ±Ÿá ⁄Øÿ±€åÿØ "),t("button",{class:"export-btn info",onClick:Je}," üìÇ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿßÿÆÿ±€åŸÜ ÿ∞ÿÆ€åÿ±Ÿá ")]),t("div",Cl,[t("button",{class:"export-btn primary",onClick:e[16]||(e[16]=l=>he("update-grid",be()))}," üöÄ ÿßÿ±ÿ≥ÿßŸÑ ÿ®Ÿá 3D "),t("button",{class:"export-btn success",onClick:Fe}," üì∑ ÿÆÿ±Ÿàÿ¨€å ÿπ⁄©ÿ≥ "),t("button",{class:"export-btn info",onClick:Be}," üñºÔ∏è ÿÆÿ±Ÿàÿ¨€å HD "),t("button",{class:"export-btn warning",onClick:Xe}," üìÑ ÿÆÿ±Ÿàÿ¨€å TXT ")])])):I("",!0)])])):I("",!0),t("div",{class:C(["mobile-dropdown-panel",{open:pe.value}])},[t("div",yl,[t("div",kl,[t("div",xl,[t("label",_l,[e[72]||(e[72]=t("span",{class:"upload-text"},"üìÅ ÿ¢ŸæŸÑŸàÿØ ŸÅÿß€åŸÑ txt grid",-1)),t("input",{type:"file",accept:".txt",class:"upload-input",onChange:st},null,32)]),t("label",$l,[e[73]||(e[73]=t("span",{class:"upload-text"},"üìÅ ÿ¢ŸæŸÑŸàÿØ ÿ™ÿµŸà€åÿ±",-1)),t("input",{type:"file",accept:"image/*",class:"upload-input",onChange:it},null,32)])]),re.value?(d(),u("div",Sl,[t("img",{src:re.value,alt:"ÿ™ÿµŸà€åÿ± ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá",class:"preview-image"},null,8,jl)])):I("",!0)]),t("div",wl,[e[87]||(e[87]=t("div",{class:"controls-header"},[t("h3",{class:"mb-4 text-lg font-bold text-gray-800"}," üé® ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß€å ÿ∑ÿ±ÿßÿ≠€å ")],-1)),t("div",Ml,[t("div",Pl,[t("div",Il,[e[74]||(e[74]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üìê ÿßÿ®ÿπÿßÿØ ÿ¥ÿ®⁄©Ÿá ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="dimensions"}]),title:v.value==="dimensions"?"Unpin Section":"Pin Section",onClick:e[17]||(e[17]=l=>F("dimensions"))},j((v.value==="dimensions","üìå")),11,Rl)]),t("div",Ol,[t("label",Ul,[e[75]||(e[75]=t("span",{class:"dimension-text"},"ÿ±ÿØ€åŸÅ‚ÄåŸáÿß:",-1)),U(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>p.value=l),type:"number",min:"1",class:"dimension-input"},null,512),[[A,p.value,void 0,{number:!0}]])]),t("label",Al,[e[76]||(e[76]=t("span",{class:"dimension-text"},"ÿ≥ÿ™ŸàŸÜ‚ÄåŸáÿß:",-1)),U(t("input",{"onUpdate:modelValue":e[19]||(e[19]=l=>b.value=l),type:"number",min:"1",class:"dimension-input"},null,512),[[A,b.value,void 0,{number:!0}]])]),t("label",Vl,[e[77]||(e[77]=t("span",{class:"dimension-text"},"ÿπÿ±ÿ∂ ÿ≥ŸÑ:",-1)),U(t("input",{"onUpdate:modelValue":e[20]||(e[20]=l=>k.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,k.value,void 0,{number:!0}]])]),t("label",Nl,[e[78]||(e[78]=t("span",{class:"dimension-text"},"ÿßÿ±ÿ™ŸÅÿßÿπ ÿ≥ŸÑ:",-1)),U(t("input",{"onUpdate:modelValue":e[21]||(e[21]=l=>x.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,x.value,void 0,{number:!0}]])])])]),t("div",zl,[t("div",El,[e[79]||(e[79]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="color"}]),title:v.value==="color"?"Unpin Section":"Pin Section",onClick:e[22]||(e[22]=l=>F("color"))},j((v.value==="color","üìå")),11,Tl)]),t("div",Dl,[U(t("input",{"onUpdate:modelValue":e[23]||(e[23]=l=>w.value=l),type:"color",class:"color-picker"},null,512),[[A,w.value]]),t("span",Gl,j(w.value),1)]),t("div",Ll,[e[80]||(e[80]=t("h4",{class:"text-sm font-semibold text-gray-700"}," üîÑ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß€å ÿßÿÆ€åÿ± ",-1)),E.value.length>0?(d(),u("button",{key:0,class:"clear-colors-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß",onClick:Ve}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")):I("",!0)]),t("div",Wl,[(d(!0),u(H,null,J(E.value,l=>(d(),u("div",{key:l,class:"color-swatch",style:ne({backgroundColor:l}),title:l,onClick:o=>w.value=l},[t("button",{class:"remove-color-btn",onClick:ve(o=>Ae(l),["stop"])}," √ó ",8,Jl)],12,Hl))),128))])]),t("div",Fl,[t("div",Bl,[e[81]||(e[81]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® ÿ≠ÿßŸÑÿ™ ÿ∑ÿ±ÿßÿ≠€å ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="mode"}]),title:v.value==="mode"?"Unpin Section":"Pin Section",onClick:e[24]||(e[24]=l=>F("mode"))},j((v.value==="mode","üìå")),11,Xl)]),t("div",Yl,[t("button",{class:C(["mode-btn",{active:N.value==="color"}]),onClick:$e}," üé® ÿ±ŸÜ⁄Ø ",2),t("button",{class:C(["mode-btn",{active:N.value==="image"}]),onClick:Se}," üñºÔ∏è ÿ™ÿµŸà€åÿ± ",2)])]),N.value==="image"?(d(),u("div",ql,[t("div",Ql,[e[82]||(e[82]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üñºÔ∏è ÿßŸÜÿ™ÿÆÿßÿ® ÿ™ÿµŸà€åÿ± ŸÖŸáÿ±Ÿá ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="image"}]),title:v.value==="image"?"Unpin Section":"Pin Section",onClick:e[25]||(e[25]=l=>F("image"))},j((v.value==="image","üìå")),11,Kl)]),t("div",Zl,[t("div",en,[(d(!0),u(H,null,J(ye.value,l=>{var o;return d(),u("div",{key:l.name,class:C(["image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"bead-image"},null,8,ln),t("span",nn,j(l.displayName),1)],10,tn)}),128))])]),V.value.length>0?(d(),u("div",on,[t("div",{class:"recent-images-header"},[e[83]||(e[83]=t("h4",{class:"text-sm font-semibold text-gray-700"}," üîÑ ÿ™ÿµÿßŸà€åÿ± ÿßÿÆ€åÿ± ",-1)),t("button",{class:"clear-images-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ™ÿµÿßŸà€åÿ±",onClick:ze}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")]),t("div",sn,[(d(!0),u(H,null,J(V.value,l=>{var o;return d(),u("div",{key:l.url,class:C(["recent-image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"recent-bead-image"},null,8,rn),t("button",{class:"remove-image-btn",onClick:ve(a=>Ne(l),["stop"])}," √ó ",8,cn)],10,an)}),128))])])):I("",!0)])):I("",!0),t("div",un,[t("div",dn,[e[84]||(e[84]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üõ†Ô∏è ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="tools"}]),title:v.value==="tools"?"Unpin Section":"Pin Section",onClick:e[26]||(e[26]=l=>F("tools"))},j((v.value==="tools","üìå")),11,vn)]),t("div",pn,[t("button",{class:C(["tool-btn primary",{active:z.value==="paint"}]),onClick:e[27]||(e[27]=l=>q("paint"))}," üñåÔ∏è Paint ",2),t("button",{class:C(["tool-btn primary",{active:z.value==="fill"}]),onClick:e[28]||(e[28]=l=>q("fill"))}," ü™£ Fill ",2),t("button",{class:C(["tool-btn secondary",{active:z.value==="select"}]),onClick:e[29]||(e[29]=l=>q("select"))}," üìê Select ",2),t("button",{class:"tool-btn secondary",onClick:Ee}," üìã Copy "),t("button",{class:"tool-btn secondary",onClick:Te}," ‚úÇÔ∏è Cut "),t("button",{class:"tool-btn secondary",onClick:te}," üìç Paste at Center "),t("button",{class:"tool-btn secondary",onClick:e[30]||(e[30]=l=>te("horizontal"))}," üìç Paste at Center (Mirror H) "),t("button",{class:"tool-btn secondary",onClick:e[31]||(e[31]=l=>te("vertical"))}," üìç Paste at Center (Mirror V) "),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[32]||(e[32]=l=>Q())}," üéØ Enable Click-to-Paste ",8,mn),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[33]||(e[33]=l=>Q("horizontal"))}," üéØ Click-to-Paste (Mirror H) ",8,bn),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[34]||(e[34]=l=>Q("vertical"))}," üéØ Click-to-Paste (Mirror V) ",8,fn),ie.value?(d(),u("button",{key:0,class:"tool-btn danger",onClick:je}," ‚ùå Cancel Click-to-Paste ")):I("",!0),t("button",{class:"tool-btn secondary",onClick:oe}," üóëÔ∏è Clear Selection "),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:De}," üîÑ Mirror Selection ",8,gn),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:Ge}," ‚ÜïÔ∏è Mirror Selection Vertical ",8,hn),t("button",{class:"tool-btn secondary",onClick:Le}," ‚Ü©Ô∏è Undo "),t("button",{class:"tool-btn secondary",onClick:We}," ‚Ü™Ô∏è Redo ")]),t("div",Cn,[e[85]||(e[85]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® Ÿæÿ≥‚Äåÿ≤ŸÖ€åŸÜŸá ",-1)),t("div",yn,[U(t("input",{"onUpdate:modelValue":e[35]||(e[35]=l=>$.value=l),type:"color",class:"color-picker",title:"ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø Ÿæÿ≥‚Äåÿ≤ŸÖ€åŸÜŸá"},null,512),[[A,$.value]]),t("button",{class:"tool-btn success",onClick:ot}," üé® ÿ™ÿ∫€å€åÿ± ÿ™ŸÖÿßŸÖ ŸÖŸáÿ±Ÿá‚ÄåŸáÿß ")])])]),t("div",kn,[t("div",xn,[e[86]||(e[86]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üì§ ÿÆÿ±Ÿàÿ¨€å ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="export"}]),title:v.value==="export"?"Unpin Section":"Pin Section",onClick:e[36]||(e[36]=l=>F("export"))},j((v.value==="export","üìå")),11,_n)]),t("div",{class:"save-load-buttons mb-3"},[t("button",{class:"export-btn success",onClick:He}," üíæ ÿ∞ÿÆ€åÿ±Ÿá ⁄Øÿ±€åÿØ "),t("button",{class:"export-btn info",onClick:Je}," üìÇ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿßÿÆÿ±€åŸÜ ÿ∞ÿÆ€åÿ±Ÿá ")]),t("div",$n,[t("button",{class:"export-btn primary",onClick:e[37]||(e[37]=l=>he("update-grid",be()))}," üöÄ ÿßÿ±ÿ≥ÿßŸÑ ÿ®Ÿá 3D "),t("button",{class:"export-btn success",onClick:Fe}," üì∑ ÿÆÿ±Ÿàÿ¨€å ÿπ⁄©ÿ≥ "),t("button",{class:"export-btn info",onClick:Be}," üñºÔ∏è ÿÆÿ±Ÿàÿ¨€å HD "),t("button",{class:"export-btn warning",onClick:Xe}," üìÑ ÿÆÿ±Ÿàÿ¨€å TXT ")])])])])])],2),t("div",{class:C(["grid-container max-md:min-h-[calc(100vh_-_310px)] md:max-h-[calc(100vh_-_200px)]",{"pinned-active":v.value}])},[Ce.value?(d(),u("div",Sn,[t("div",jn,[t("label",wn,[e[88]||(e[88]=t("span",{class:"upload-text"},"üìÅ ÿ¢ŸæŸÑŸàÿØ ŸÅÿß€åŸÑ txt grid",-1)),t("input",{type:"file",accept:".txt",class:"upload-input",onChange:st},null,32)]),t("label",Mn,[e[89]||(e[89]=t("span",{class:"upload-text"},"üìÅ ÿ¢ŸæŸÑŸàÿØ ÿ™ÿµŸà€åÿ±",-1)),t("input",{type:"file",accept:"image/*",class:"upload-input",onChange:it},null,32)])]),re.value?(d(),u("div",Pn,[t("img",{src:re.value,alt:"ÿ™ÿµŸà€åÿ± ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá",class:"preview-image"},null,8,In)])):I("",!0)])):I("",!0),t("div",Rn,[t("div",On,[t("div",{ref_key:"gridWrapper",ref:ft,class:"h-[80vh] overflow-auto rounded border bg-white p-2"},[Qe.value&&S.value==="vertical"?(d(),u("div",Un,[(d(!0),u(H,null,J(Ye.value,l=>(d(),u("div",{key:l,class:"flex-shrink-0",style:ne({width:k.value+"px"})},[t("div",{class:"flex flex-col",style:ne(_t(l))},[(d(!0),u(H,null,J(qe.value,o=>(d(),u("div",{key:`${o}-${l}`,class:"cell cursor-pointer border-[1px] border-gray-200",style:ne(at(o,l)),onMousedown:a=>Ze(o,l),onMouseenter:a=>et(o,l)},null,44,An))),128))],4)],4))),128))])):Qe.value&&S.value==="horizontal"?(d(),u("div",Vn,[(d(!0),u(H,null,J(qe.value,l=>(d(),u("div",{key:l,class:"flex flex-shrink-0 items-start",style:ne({height:x.value+"px",width:"100%"})},[t("div",{class:"flex items-start",style:ne($t(l))},[(d(!0),u(H,null,J(Ye.value,o=>(d(),u("div",{key:`${l}-${o}`,class:"cell flex-shrink-0 cursor-pointer border-[1px] border-gray-200",style:ne(at(l,o)),onMousedown:a=>Ze(l,o),onMouseenter:a=>et(l,o)},null,44,Nn))),128))],4)],4))),128))])):(d(),u("div",zn," Loading grid... "))],512),e[90]||(e[90]=t("p",{class:"mt-2 text-xs text-gray-500"}," ÿ±ÿßÿ≥ÿ™‚Äå⁄©ŸÑ€å⁄© = Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ. ŸÖ€å‚Äåÿ™ŸàÿßŸÜ€å ÿ™ÿπÿØÿßÿØ ÿ±ÿØ€åŸÅ/ÿ≥ÿ™ŸàŸÜ ÿ±ÿß ÿØÿ± ŸÖÿ™ÿ∫€åÿ±Ÿáÿß ÿ™ÿ∫€å€åÿ± ÿ®ÿØŸá€å. ",-1))])])],2),t("div",En,[e[101]||(e[101]=t("div",{class:"controls-header"},[t("h3",{class:"mb-4 text-lg font-bold text-gray-800"},"üé® ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß€å ÿ∑ÿ±ÿßÿ≠€å")],-1)),t("div",Tn,[t("div",Dn,[t("div",Gn,[e[91]||(e[91]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üìê ÿßÿ®ÿπÿßÿØ ÿ¥ÿ®⁄©Ÿá ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="dimensions"}]),title:v.value==="dimensions"?"Unpin Section":"Pin Section",onClick:e[38]||(e[38]=l=>F("dimensions"))},j((v.value==="dimensions","üìå")),11,Ln)]),t("div",Wn,[t("label",Hn,[t("span",Jn,"ÿ±ÿØ€åŸÅ‚ÄåŸáÿß: "+j(p.value),1),U(t("input",{"onUpdate:modelValue":e[39]||(e[39]=l=>p.value=l),type:"number",min:"1",max:"200",class:"dimension-input"},null,512),[[A,p.value,void 0,{number:!0}]])]),t("label",Fn,[t("span",Bn,"ÿ≥ÿ™ŸàŸÜ‚ÄåŸáÿß: "+j(b.value),1),U(t("input",{"onUpdate:modelValue":e[40]||(e[40]=l=>b.value=l),type:"number",min:"1",max:"200",class:"dimension-input"},null,512),[[A,b.value,void 0,{number:!0}]])]),t("label",Xn,[t("span",Yn,"ÿπÿ±ÿ∂ ÿ≥ŸÑ: "+j(k.value)+"px",1),U(t("input",{"onUpdate:modelValue":e[41]||(e[41]=l=>k.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,k.value,void 0,{number:!0}]])]),t("label",qn,[t("span",Qn,"ÿßÿ±ÿ™ŸÅÿßÿπ ÿ≥ŸÑ: "+j(x.value)+"px",1),U(t("input",{"onUpdate:modelValue":e[42]||(e[42]=l=>x.value=l),type:"number",min:"5",max:"50",class:"dimension-input"},null,512),[[A,x.value,void 0,{number:!0}]])]),t("div",Kn,[e[92]||(e[92]=t("span",{class:"dimension-text"},"ÿ¨Ÿáÿ™ ⁄Øÿ±€åÿØ:",-1)),t("div",Zn,[t("button",{class:C(["orientation-toggle-btn",{active:S.value==="vertical"}]),onClick:e[43]||(e[43]=l=>S.value="vertical")}," ‚ÜïÔ∏è ÿπŸÖŸàÿØ€å ",2),t("button",{class:C(["orientation-toggle-btn",{active:S.value==="horizontal"}]),onClick:e[44]||(e[44]=l=>S.value="horizontal")}," ‚ÜîÔ∏è ÿßŸÅŸÇ€å ",2)])])]),t("div",eo,[t("button",{class:"show-image-section-btn text-blue-500 !mt-2",onClick:e[45]||(e[45]=l=>Ce.value=!Ce.value)},j(Ce.value?"üîç Show Image Section":"üîç Hide Image Section"),1)])]),t("div",to,[t("div",lo,[e[93]||(e[93]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="color"}]),title:v.value==="color"?"Unpin Section":"Pin Section",onClick:e[46]||(e[46]=l=>F("color"))},j((v.value==="color","üìå")),11,no)]),t("div",oo,[U(t("input",{"onUpdate:modelValue":e[47]||(e[47]=l=>w.value=l),type:"color",class:"color-picker",onChange:$e},null,544),[[A,w.value]]),t("span",so,j(w.value),1)]),t("div",io,[e[94]||(e[94]=t("h4",{class:"text-sm font-semibold text-gray-700"},"üîÑ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß€å ÿßÿÆ€åÿ±",-1)),E.value.length>0?(d(),u("button",{key:0,class:"clear-colors-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ±ŸÜ⁄Ø‚ÄåŸáÿß",onClick:Ve}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")):I("",!0)]),t("div",ao,[(d(!0),u(H,null,J(E.value,l=>(d(),u("div",{key:l,class:"color-swatch",style:ne({backgroundColor:l}),title:l,onClick:o=>w.value=l},[t("button",{class:"remove-color-btn",onClick:ve(o=>Ae(l),["stop"])}," √ó ",8,co)],12,ro))),128))])]),t("div",uo,[t("div",vo,[e[95]||(e[95]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® ÿ≠ÿßŸÑÿ™ ÿ∑ÿ±ÿßÿ≠€å ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="mode"}]),title:v.value==="mode"?"Unpin Section":"Pin Section",onClick:e[48]||(e[48]=l=>F("mode"))},j((v.value==="mode","üìå")),11,po)]),t("div",mo,[t("button",{class:C(["mode-btn",{active:N.value==="color"}]),onClick:$e}," üé® ÿ±ŸÜ⁄Ø ",2),t("button",{class:C(["mode-btn",{active:N.value==="image"}]),onClick:Se}," üñºÔ∏è ÿ™ÿµŸà€åÿ± ",2)])]),N.value==="image"?(d(),u("div",bo,[t("div",fo,[e[96]||(e[96]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üñºÔ∏è ÿßŸÜÿ™ÿÆÿßÿ® ÿ™ÿµŸà€åÿ± ŸÖŸáÿ±Ÿá ",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="image"}]),title:v.value==="image"?"Unpin Section":"Pin Section",onClick:e[49]||(e[49]=l=>F("image"))},j((v.value==="image","üìå")),11,go)]),t("div",ho,[t("div",Co,[(d(!0),u(H,null,J(ye.value,l=>{var o;return d(),u("div",{key:l.name,class:C(["image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"bead-image"},null,8,ko),t("span",xo,j(l.displayName),1)],10,yo)}),128))])]),V.value.length>0?(d(),u("div",_o,[t("div",{class:"recent-images-header"},[e[97]||(e[97]=t("h4",{class:"text-sm font-semibold text-gray-700"}," üîÑ ÿ™ÿµÿßŸà€åÿ± ÿßÿÆ€åÿ± ",-1)),t("button",{class:"clear-images-btn",title:"Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ÿ™ŸÖÿßŸÖ ÿ™ÿµÿßŸà€åÿ±",onClick:ze}," üóëÔ∏è Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ")]),t("div",$o,[(d(!0),u(H,null,J(V.value,l=>{var o;return d(),u("div",{key:l.url,class:C(["recent-image-item",{selected:((o=R.value)==null?void 0:o.url)===l.url}]),onClick:a=>de(l)},[t("img",{src:l.url,alt:l.displayName,class:"recent-bead-image"},null,8,jo),t("button",{class:"remove-image-btn",onClick:ve(a=>Ne(l),["stop"])}," √ó ",8,wo)],10,So)}),128))])])):I("",!0)])):I("",!0),t("div",Mo,[t("div",Po,[e[98]||(e[98]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"},"üõ†Ô∏è ÿßÿ®ÿ≤ÿßÿ±Ÿáÿß",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="tools"}]),title:v.value==="tools"?"Unpin Section":"Pin Section",onClick:e[50]||(e[50]=l=>F("tools"))},j((v.value==="tools","üìå")),11,Io)]),t("div",Ro,[t("button",{class:C(["tool-btn primary",{active:z.value==="paint"}]),onClick:e[51]||(e[51]=l=>q("paint"))}," üñåÔ∏è Paint ",2),t("button",{class:C(["tool-btn primary",{active:z.value==="fill"}]),onClick:e[52]||(e[52]=l=>q("fill"))}," ü™£ Fill ",2),t("button",{class:C(["tool-btn secondary",{active:z.value==="select"}]),onClick:e[53]||(e[53]=l=>q("select"))}," üìê Select ",2),t("button",{class:C(["tool-btn secondary",{active:z.value==="selectRect"}]),onClick:e[54]||(e[54]=l=>q("selectRect"))}," üì¶ Select Rectangle ",2),t("button",{class:"tool-btn secondary",onClick:Ee}," üìã Copy "),t("button",{class:"tool-btn secondary",onClick:Te}," ‚úÇÔ∏è Cut "),t("button",{class:"tool-btn secondary",onClick:te}," üìç Paste at Center "),t("button",{class:"tool-btn secondary",onClick:e[55]||(e[55]=l=>te("horizontal"))}," üìç Paste at Center (Mirror H) "),t("button",{class:"tool-btn secondary",onClick:e[56]||(e[56]=l=>te("vertical"))}," üìç Paste at Center (Mirror V) "),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[57]||(e[57]=l=>Q())}," üéØ Enable Click-to-Paste ",8,Oo),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[58]||(e[58]=l=>Q("horizontal"))}," üéØ Click-to-Paste (Mirror H) ",8,Uo),t("button",{class:"tool-btn secondary",disabled:!le(),onClick:e[59]||(e[59]=l=>Q("vertical"))}," üéØ Click-to-Paste (Mirror V) ",8,Ao),ie.value?(d(),u("button",{key:0,class:"tool-btn danger",onClick:je}," ‚ùå Cancel Click-to-Paste ")):I("",!0),t("button",{class:"tool-btn secondary",onClick:oe}," üóëÔ∏è Clear Selection "),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:De}," üîÑ Mirror Selection ",8,Vo),t("button",{class:"tool-btn secondary",disabled:M.value.length===0,onClick:Ge}," ‚ÜïÔ∏è Mirror Selection Vertical ",8,No),t("button",{class:"tool-btn secondary",onClick:Le}," ‚Ü©Ô∏è Undo "),t("button",{class:"tool-btn secondary",onClick:We}," ‚Ü™Ô∏è Redo ")]),t("div",zo,[e[99]||(e[99]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," üé® ÿ±ŸÜ⁄Ø Ÿæÿ≥‚Äåÿ≤ŸÖ€åŸÜŸá ",-1)),t("div",Eo,[U(t("input",{"onUpdate:modelValue":e[60]||(e[60]=l=>$.value=l),type:"color",class:"color-picker",title:"ÿßŸÜÿ™ÿÆÿßÿ® ÿ±ŸÜ⁄Ø Ÿæÿ≥‚Äåÿ≤ŸÖ€åŸÜŸá"},null,512),[[A,$.value]]),t("button",{class:"tool-btn success",onClick:ot}," üé® ÿ™ÿ∫€å€åÿ± ÿ™ŸÖÿßŸÖ ŸÖŸáÿ±Ÿá‚ÄåŸáÿß ")])])]),t("div",To,[t("div",Do,[e[100]||(e[100]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"},"üì§ ÿÆÿ±Ÿàÿ¨€å",-1)),t("button",{class:C(["pin-btn",{pinned:v.value==="export"}]),title:v.value==="export"?"Unpin Section":"Pin Section",onClick:e[61]||(e[61]=l=>F("export"))},j((v.value==="export","üìå")),11,Go)]),t("div",{class:"save-load-buttons mb-3"},[t("button",{class:"export-btn success",onClick:He}," üíæ ÿ∞ÿÆ€åÿ±Ÿá ⁄Øÿ±€åÿØ "),t("button",{class:"export-btn info",onClick:Je}," üìÇ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿßÿÆÿ±€åŸÜ ÿ∞ÿÆ€åÿ±Ÿá ")]),t("div",Lo,[t("button",{class:"export-btn primary",onClick:e[62]||(e[62]=l=>he("update-grid",be()))}," üöÄ ÿßÿ±ÿ≥ÿßŸÑ ÿ®Ÿá 3D "),t("button",{class:"export-btn success",onClick:Fe}," üì∑ ÿÆÿ±Ÿàÿ¨€å ÿπ⁄©ÿ≥ "),t("button",{class:"export-btn info",onClick:Be}," üñºÔ∏è ÿÆÿ±Ÿàÿ¨€å HD "),t("button",{class:"export-btn warning",onClick:Xe}," üìÑ ÿÆÿ±Ÿàÿ¨€å TXT ")])])])])]))}},Jo=jt(Wo,[["__scopeId","data-v-0738f7fe"]]);export{Jo as G};
