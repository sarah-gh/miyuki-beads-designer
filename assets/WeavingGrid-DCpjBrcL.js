import{_ as j,r as u,m as re,w as N,n as ce,p as ue,c as P,a as t,q as C,v as T,t as k,b as z,F as de,u as ve,x as J,y as fe,o as A,z as pe,A as me,B as E,C as G,D as ge,E as be,W as he}from"./index-z46LpOSa.js";import{G as xe}from"./PeyoteGridEditor-D6wv1j_U.js";const _e={class:"editor-container"},ye={class:"controls-panel"},we={class:"controls-content"},ke={class:"dimensions-section"},Ce={class:"dimension-inputs"},$e={class:"dimension-label"},Be={class:"dimension-value"},Fe={class:"dimension-label"},Pe={class:"dimension-value"},Ae={class:"dimension-label"},Ue={class:"dimension-value"},Se={class:"color-section"},Me={class:"color-picker-container"},Ee={class:"color-value"},Ge={class:"recent-colors-header mt-3!"},Re={class:"recent-colors-grid"},Te=["title","onClick"],Ve=["onClick"],De={class:"tools-section"},Oe={class:"tools-grid"},Le={class:"export-section"},We={class:"grid-container"},Ie={class:"image-section"},Ne={class:"upload-section"},ze={class:"upload-label mb-2!"},Je={class:"upload-label"},je={key:0,class:"image-preview"},qe=["src"],He={class:"canvas-wrapper"},Xe={class:"canvas-header"},Ye={class:"text-xs text-gray-500"},Ke={class:"canvas-container"},Qe={class:"canvas-info"},Ze={class:"mb-2 flex items-center gap-2"},et={class:"flex items-center gap-2 text-sm"},tt={__name:"WeavingGridEditor",emits:["update-grid"],setup(q){const o=u(80),i=u(10),d=u(20),p=u(!0),_=u("paint"),m=u(["#8B2D2B","#D36B43","#E9C76A","#172B4A","#FFFFFF"][3]),r=u([]),U=u(null),y=u(null);let g=null;const b=re({data:[]});function S(){b.data=Array.from({length:i.value},()=>Array.from({length:o.value},()=>null))}const B=u([]);function w(n){B.value.push(n),B.value.length>50&&B.value.shift()}function x(){const n=B.value.pop();n&&(b.data=n,F())}function O(){const n=window.devicePixelRatio||1,e=(o.value+(p.value?.5:0))*d.value,s=i.value*d.value,l=y.value;l.width=Math.round(e*n),l.height=Math.round(s*n),l.style.width=`${Math.round(e)}px`,l.style.height=`${Math.round(s)}px`,g.setTransform(n,0,0,n,0,0)}function H(n,e,s,l){const v=s*.18;g.fillStyle=l||"#f3f4f6",g.beginPath(),X(g,n,e,s,s,v),g.fill(),g.lineWidth=Math.max(.6,s*.06),g.strokeStyle="rgba(0,0,0,0.06)",g.stroke()}function X(n,e,s,l,v,c){n.beginPath(),n.moveTo(e+c,s),n.arcTo(e+l,s,e+l,s+v,c),n.arcTo(e+l,s+v,e,s+v,c),n.arcTo(e,s+v,e,s,c),n.arcTo(e,s,e+l,s,c),n.closePath()}function F(){if(!g)return;g.clearRect(0,0,y.value.width,y.value.height);const n=d.value;for(let e=0;e<i.value;e++)for(let s=0;s<o.value;s++){const l=p.value&&e%2===1?n/2:0,v=s*n+l,c=e*n,a=b.data[e]&&b.data[e][s];H(v,c,n,a)}}function Y(n,e){const s=y.value.getBoundingClientRect(),l=n-s.left,v=e-s.top,c=d.value,a=Math.floor(v/c),h=p.value&&a%2===1?c/2:0,f=Math.floor((l-h)/c);return a<0||a>=i.value||f<0||f>=o.value?null:{r:a,c:f}}let V=!1;function K(n){n.preventDefault(),y.value.setPointerCapture(n.pointerId),V=!0,w(JSON.parse(JSON.stringify(b.data))),W(n)}function Q(n){V&&W(n)}function L(n){V=!1;try{y.value.releasePointerCapture(n.pointerId)}catch{}}function W(n){const e=Y(n.clientX,n.clientY);if(!e)return;const{r:s,c:l}=e;b.data[s][l]=m.value==="#FFFFFF"?null:m.value,ee(m.value),F()}function I(n){_.value=n}function Z(){w(JSON.parse(JSON.stringify(b.data))),S(),F()}function ee(n){const e=r.value.indexOf(n);e>-1&&r.value.splice(e,1),r.value.unshift(n),r.value.length>10&&(r.value=r.value.slice(0,10))}function te(n){const e=r.value.indexOf(n);e>-1&&r.value.splice(e,1)}function se(){r.value=[]}function ne(){const n=document.createElement("canvas"),e=n.getContext("2d"),s=d.value,l=20,v=o.value*s+l*2,c=i.value*s+l*2;n.width=v,n.height=c,e.fillStyle="#ffffff",e.fillRect(0,0,v,c);for(let a=0;a<i.value;a++)for(let h=0;h<o.value;h++){const f=b.data[a]&&b.data[a][h];if(f){e.fillStyle=f;const M=p.value&&a%2===1?s/2:0,D=l+h*s+M,ie=l+a*s;e.fillRect(D,ie,s,s)}}n.toBlob(a=>{const h=URL.createObjectURL(a),f=document.createElement("a");f.href=h,f.download=`weaving_grid_${o.value}x${i.value}_${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.png`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(h)},"image/png")}function le(){return b.data}function oe(n){const e=n.target.files[0];if(e){const s=new FileReader;s.onload=l=>{try{const v=l.target.result.trim(),c=JSON.parse(v);if(Array.isArray(c)&&c.every(a=>typeof a=="string"&&a.match(/^#[0-9A-Fa-f]{6}$/))){const a=[];for(let h=0;h<i.value;h++){const f=[];for(let M=0;M<o.value;M++){const D=h*o.value+M;f.push(c[D]||null)}a.push(f)}b.data=a,F()}}catch(v){console.error("Error parsing text file:",v)}},s.readAsText(e)}}function ae(n){const e=n.target.files[0];e&&(U.value=URL.createObjectURL(e))}N([o,i],()=>{S(),R()}),N([d,p],()=>{R()});function R(){requestAnimationFrame(()=>{O(),F()})}return ce(()=>{g=y.value.getContext("2d"),S(),O(),F(),window.addEventListener("resize",R)}),ue(()=>{window.removeEventListener("resize",R)}),(n,e)=>(A(),P("div",_e,[t("div",ye,[e[16]||(e[16]=t("div",{class:"controls-header"},[t("h3",{class:"mb-4 text-lg font-bold text-gray-800"},"🎨 ابزارهای طراحی")],-1)),t("div",we,[t("div",ke,[e[11]||(e[11]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," 📐 ابعاد شبکه ",-1)),t("div",Ce,[t("label",$e,[e[8]||(e[8]=t("span",{class:"dimension-text"},"ستون‌ها (عرض):",-1)),C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),type:"range",min:"8",max:"160",class:"dimension-range"},null,512),[[T,o.value,void 0,{number:!0}]]),t("span",Be,k(o.value),1)]),t("label",Fe,[e[9]||(e[9]=t("span",{class:"dimension-text"},"ردیف‌ها (طول):",-1)),C(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),type:"range",min:"8",max:"400",class:"dimension-range"},null,512),[[T,i.value,void 0,{number:!0}]]),t("span",Pe,k(i.value),1)]),t("label",Ae,[e[10]||(e[10]=t("span",{class:"dimension-text"},"اندازه مهره:",-1)),C(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),type:"range",min:"6",max:"28",class:"dimension-range"},null,512),[[T,d.value,void 0,{number:!0}]]),t("span",Ue,k(d.value)+"px",1)])])]),t("div",Se,[e[13]||(e[13]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"}," 🎨 انتخاب رنگ ",-1)),t("div",Me,[C(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>m.value=s),type:"color",class:"color-picker"},null,512),[[T,m.value]]),t("span",Ee,k(m.value),1)]),t("div",Ge,[e[12]||(e[12]=t("h4",{class:"text-sm font-semibold text-gray-700"},"🔄 رنگ‌های اخیر",-1)),r.value.length>0?(A(),P("button",{key:0,class:"clear-colors-btn",title:"پاک کردن تمام رنگ‌ها",onClick:se}," 🗑️ پاک کردن ")):z("",!0)]),t("div",Re,[(A(!0),P(de,null,ve(r.value,s=>(A(),P("div",{key:s,class:"color-swatch",style:pe({backgroundColor:s}),title:s,onClick:l=>m.value=s},[t("button",{class:"remove-color-btn",onClick:me(l=>te(s),["stop"])}," × ",8,Ve)],12,Te))),128))])]),t("div",De,[e[14]||(e[14]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"},"🛠️ ابزارها",-1)),t("div",Oe,[t("button",{class:J(["tool-btn primary",{active:_.value==="paint"}]),onClick:e[4]||(e[4]=s=>I("paint"))}," 🖌️ Paint ",2),t("button",{class:J(["tool-btn primary",{active:_.value==="fill"}]),onClick:e[5]||(e[5]=s=>I("fill"))}," 🪣 Fill ",2),t("button",{class:"tool-btn secondary",onClick:x}," ↩️ Undo "),t("button",{class:"tool-btn secondary",onClick:Z}," 🗑️ Clear All ")])]),t("div",Le,[e[15]||(e[15]=t("h4",{class:"mb-2 text-sm font-semibold text-gray-700"},"📤 خروجی",-1)),t("button",{class:"export-btn primary",onClick:e[6]||(e[6]=s=>n.$emit("update-grid",le()))}," 🚀 ارسال به 3D "),t("button",{class:"export-btn success",onClick:ne}," 📷 خروجی عکس ")])])]),t("div",We,[t("div",Ie,[t("div",Ne,[t("label",ze,[e[17]||(e[17]=t("span",{class:"upload-text"},"📁 آپلود فایل txt grid",-1)),t("input",{type:"file",accept:".txt",class:"upload-input",onChange:oe},null,32)]),t("label",Je,[e[18]||(e[18]=t("span",{class:"upload-text"},"📁 آپلود تصویر",-1)),t("input",{type:"file",accept:"image/*",class:"upload-input",onChange:ae},null,32)])]),U.value?(A(),P("div",je,[t("img",{src:U.value,alt:"تصویر انتخاب شده",class:"preview-image"},null,8,qe)])):z("",!0)]),t("div",He,[t("div",Xe,[e[19]||(e[19]=t("div",{class:"text-sm font-medium"},"نمایش عمودی (90° چرخش فرض شده)",-1)),t("div",Ye," | ستون‌ها: "+k(o.value)+" × ردیف‌ها: "+k(i.value),1)]),t("div",Ke,[t("canvas",{ref_key:"canvas",ref:y,class:"mx-auto block",onPointerdown:K,onPointermove:Q,onPointerup:L,onPointerleave:L},null,544)]),t("div",Qe,[t("div",Ze,[t("label",et,[C(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>p.value=s),type:"checkbox"},null,512),[[fe,p.value]]),e[20]||(e[20]=t("span",null,"حالت اجرچینی (Brick)",-1))])]),e[21]||(e[21]=t("div",{class:"text-xs text-gray-600"},' نکته: "حالت اجرچینی" هر ردیف زوج یا فرد را نیم مهره جابه‌جا می‌کند تا ظاهر بافت Brick Stitch شبیه‌سازی شود. ',-1))])])])]))}},st=j(tt,[["__scopeId","data-v-d7945ffc"]]),nt={class:"home-container"},lt={class:"app-header flex items-start justify-between mb-3!"},ot={class:"stats-section"},at={class:"stat-item"},it={class:"stat-number"},rt={class:"stat-item"},ct={class:"stat-number"},ut={class:"stat-item"},dt={class:"stat-number"},vt={class:"stat-item"},ft={class:"stat-number"},pt={class:"content-container"},mt={__name:"WeavingGrid",setup(q){const o=u(16),i=u(80),d=u(Array(16*80).fill("#ffffff")),p=u(!0),_=u(!1),$=u(!1),m=u(!1),r=u(!1);function U(){p.value=!0,_.value=!1,$.value=!1,m.value=!1,r.value=!1}function y(){r.value=!0,p.value=!1,_.value=!1,$.value=!1,m.value=!1}function g(){_.value=!0,p.value=!1,$.value=!1,m.value=!1,r.value=!1}function b(){$.value=!0,_.value=!1,p.value=!1,m.value=!1,r.value=!1}function S(){m.value=!0,p.value=!1,_.value=!1,$.value=!1,r.value=!1}function B(w){if(!Array.isArray(w)||w.length===0){d.value=[],o.value=0,i.value=0;return}o.value=w.length,i.value=Array.isArray(w[0])?w[0].length:0,d.value=w.flat()}return(w,x)=>(A(),P("div",nt,[t("header",lt,[t("div",{class:"header-content"},[x[0]||(x[0]=t("div",{class:"logo-section"},[t("h1",{class:"app-title text-2xl"},"🎨 Miyuki Beads Designer - Flat Style")],-1)),t("div",{class:"header-actions mt-3! flex items-center gap-2"},[t("button",{class:"rounded-md bg-cyan-950 px-4! py-2! text-[18px] text-white",onClick:U}," ویرایشگر شبکه "),t("button",{class:"rounded-md bg-blue-900 px-4! py-2! text-[18px] text-white",onClick:y}," ویرایشگر شبکه پیچ "),t("button",{class:"rounded-md bg-blue-900 px-4! py-2! text-[18px] text-white",onClick:g}," نمایش مهره‌ها "),t("button",{class:"rounded-md bg-emerald-900 px-4! py-2! text-[18px] text-white",onClick:b}," پیش‌نمایش دستبند "),t("button",{class:"rounded-md bg-emerald-900 px-4! py-2! text-[18px] text-white",onClick:S}," مراحل اجرا ")])]),t("div",ot,[t("div",at,[t("div",it,k(o.value),1),x[1]||(x[1]=t("div",{class:"stat-label"},"ردیف",-1))]),t("div",rt,[t("div",ct,k(i.value),1),x[2]||(x[2]=t("div",{class:"stat-label"},"ستون",-1))]),t("div",ut,[t("div",dt,k(d.value.length),1),x[3]||(x[3]=t("div",{class:"stat-label"},"مهره",-1))]),t("div",vt,[t("div",ft,k((d.value.length/190).toFixed(2)),1),x[4]||(x[4]=t("div",{class:"stat-label"},"گرم",-1))])])]),t("div",pt,[C(G(xe,{class:"content-component",onUpdateGrid:B},null,512),[[E,r.value]]),C(G(st,{class:"content-component",onUpdateGrid:B},null,512),[[E,p.value]]),C(G(ge,{pattern:d.value,rows:o.value,cols:i.value,class:"content-component"},null,8,["pattern","rows","cols"]),[[E,_.value]]),C(G(be,{pattern:d.value,rows:o.value,cols:i.value,class:"content-component"},null,8,["pattern","rows","cols"]),[[E,$.value]]),C(G(he,{pattern:d.value,rows:o.value,cols:i.value,class:"content-component"},null,8,["pattern","rows","cols"]),[[E,m.value]])])]))}},ht=j(mt,[["__scopeId","data-v-6ca23468"]]);export{ht as default};
